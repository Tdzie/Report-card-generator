<!DOCTYPE html>
<html>
<head>
<title>Keyed In Report</title>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
<script type="text/javascript">

    
    function Upload1() {
        //Reference the FileUpload element.
        var fileUpload = document.getElementById("fileUpload1");
 
       
            if (typeof (FileReader) != "undefined") {
                var reader1 = new FileReader();
 
                //For Browsers other than IE.
                if (reader1.readAsBinaryString) {
                    reader1.onload = function (e) {
                        ProcessExcel2(e.target.result);
                    };
                    reader1.readAsBinaryString(fileUpload1.files[0]);
                } else {
                    //For IE Browser.
                    reader.onload = function (e) {
                        var data1 = "";
                        var bytes1 = new Uint8Array(e.target.result);
                        for (var i = 0; i < bytes1.byteLength; i++) {
                            data1 += String.fromCharCode(bytes1[i]);
                        }
                        ProcessExcel2(data1);
                    };
                    reader1.readAsArrayBuffer(fileUpload1.files[0]);
                }
            } else {
                alert("This browser does not support HTML5.");
            }
    };
    function ProcessExcel2(data1) {
        //Read the Excel File data.
        var workbook = XLSX.read(data1, {
            type: 'binary'
        });
 
        //Fetch the name of First Sheet.
        var firstSheet = workbook.SheetNames[0];
 
        //Read all rows from First Sheet into an JSON array.
        var excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);
        arr2 = excelRows;
        console.log(excelRows);
 /*
        //Create a HTML Table element.
        var table = document.createElement("table");
        table.border = "1";
 
        //Add the header row.
        var row = table.insertRow(-1);
 
        //Add the header cells.
        var headerCell = document.createElement("TH");
        headerCell.innerHTML = "Id";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "First Name";
        row.appendChild(headerCell);
 
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Last Name";
        row.appendChild(headerCell);
 
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "All count";
        row.appendChild(headerCell);

	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "All $";
        row.appendChild(headerCell);
	
	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Grocery count";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Grocery $";
        row.appendChild(headerCell);
 
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "GM/HBC count";
        row.appendChild(headerCell);

	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "GM/HBC $";
        row.appendChild(headerCell);
	
	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Bakery count";
        row.appendChild(headerCell);
        
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Bakery $";
        row.appendChild(headerCell);
 
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Beer/wine count";
        row.appendChild(headerCell);

	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Beer/wine $";
        row.appendChild(headerCell);
	
	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Deli/PrepFood count";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Deli/PrepFood $";
        row.appendChild(headerCell);
 
        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Floral count";
        row.appendChild(headerCell);

	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Floral $";
        row.appendChild(headerCell);
	
	    headerCell = document.createElement("TH");
        headerCell.innerHTML = "Meat count";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Meat $";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Produce count";
        row.appendChild(headerCell);

         headerCell = document.createElement("TH");
        headerCell.innerHTML = "Produce $";
        row.appendChild(headerCell);

        headerCell = document.createElement("TH");
        headerCell.innerHTML = "Seafood count";
        row.appendChild(headerCell);

         headerCell = document.createElement("TH");
        headerCell.innerHTML = "Seafood $";
        row.appendChild(headerCell);
        */
 
        //Add the data rows from Excel file.
        for (var i = 8; i < excelRows.length; i++) {
            if(i == excelRows.length-1){
                ezScanAdd();
            }
            /*
            //Add the data row.
            var row = table.insertRow(-1);
 		
            //Add the data cells.
            var cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i]["Keyed By Department"];

            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_1;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_2;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_3;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_4;
            
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_5;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_6;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_7;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_8;

            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_9;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_10;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_11;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_12;

            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_13;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_14;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_15;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_16;

            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_17;
 
            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_18;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_19;

	        cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_20;

            cell = row.insertCell(-1);
            cell.innerHTML = excelRows[i].__EMPTY_21;
	*/
	    runner(excelRows[i]);
        }
        
        
        
    console.log(topTen);
 /*     
        var dvExcel = document.getElementById("dvExcel1");

        dvExcel1.innerHTML = "";
        dvExcel1.appendChild(table);*/
    };

    // array to count ez scan
    var allC = 0;
    var allV = 0;
    var groceryC = 0;
    var groceryV = 0;
    var gmC = 0;
    var gmV = 0;
    var bakeryC = 0;
    var bakeryV = 0;
    var beerC = 0;
    var beerV = 0;
    var deliC = 0;
    var deliV = 0;
    var floralC = 0;
    var floralV = 0;
    var meatC = 0;
    var meatV = 0;
    var produceC = 0;
    var produceV = 0;
    var seafoodC = 0;
    var seafoodV = 0;

   function ezScanAdd(){
       arr = [{
        __EMPTY: "EZ",
        __EMPTY_1: "SCAN",
        __EMPTY_2: allC,
        __EMPTY_3: allV.toFixed(2),
        __EMPTY_4: groceryC,
        __EMPTY_5: groceryV.toFixed(2),
        __EMPTY_6: gmC,
        __EMPTY_7: gmV.toFixed(2),
        __EMPTY_8: bakeryC,
        __EMPTY_9: bakeryV.toFixed(2),
        __EMPTY_10: beerC,
        __EMPTY_11: beerV.toFixed(2),
        __EMPTY_12: deliC,
        __EMPTY_13: deliV.toFixed(2),
        __EMPTY_14: floralC,
        __EMPTY_15: floralV.toFixed(2),
        __EMPTY_16: meatC,
        __EMPTY_17: meatV.toFixed(2),
        __EMPTY_18: produceC,
        __EMPTY_19: produceV.toFixed(2),
        __EMPTY_20: seafoodC,
        __EMPTY_21: seafoodV.toFixed(2),
       }
       
   ];
    console.log(arr);
   runner(arr[0]);
   }

//make a array for top 10
 var topTen = [];
    function runner(a){	
    var testd = document.getElementById("test");
    if(a.__EMPTY == "--"){

        allC += parseFloat(a.__EMPTY_2);
        allV += parseFloat(a.__EMPTY_3);
        groceryC += parseFloat(a.__EMPTY_4);
        groceryV += parseFloat(a.__EMPTY_5);
        gmC += parseFloat(a.__EMPTY_6);
        gmV += parseFloat(a.__EMPTY_7);
        bakeryC += parseFloat(a.__EMPTY_8);
        bakeryV += parseFloat(a.__EMPTY_9);
        beerC += parseFloat(a.__EMPTY_10);
        beerV += parseFloat(a.__EMPTY_11);
        deliC += parseFloat(a.__EMPTY_12);
        deliV += parseFloat(a.__EMPTY_13);
        floralC += parseFloat(a.__EMPTY_14);
        floralV += parseFloat(a.__EMPTY_15);
        meatC += parseFloat(a.__EMPTY_16);
        meatV += parseFloat(a.__EMPTY_17);
        produceC += parseFloat(a.__EMPTY_18);
        produceV += parseFloat(a.__EMPTY_19);
        seafoodC += parseFloat(a.__EMPTY_20);
        seafoodV += parseFloat(a.__EMPTY_21);
    }else{
        
    let name = a.__EMPTY;
    let namel = a.__EMPTY_1;
    let totalC = a.__EMPTY_2;
    let totalV = a.__EMPTY_3;
    let tempTopTen ={"name": name, "lname": namel, "count": totalC, "value": totalV};

    topTen.push(tempTopTen);

    var di = document.createElement("div");
    di.classList.add("border");	
    di.setAttribute("id","add");
    testd.appendChild(di);
    var add = document.getElementById("add");
    // create wrapper
    di = document.createElement("div");
    
    di.setAttribute("id","inwrap");
    di.classList.add("inboxhead");
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    if(a.__EMPTY == null){
        di.innerHTML = "STORE TOTAL";
    }
    else{
    di.innerHTML = a.__EMPTY + " " + a.__EMPTY_1;}
    
    nn.appendChild(di);
    
   
        // reset id
    nn.setAttribute("id","nothing");
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "ALL";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.classList.add("inbox");
    di.innerHTML ="Count: " + a.__EMPTY_2;
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_3;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");


    if(a.__EMPTY_4 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "Grocery";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_4;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_5;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
    }

    if(a.__EMPTY_6 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "GM/HBC";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_6;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_7;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
    }// END IF STATEMENT

if(a.__EMPTY_8 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "BAKERY";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_8;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_9;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}

if(a.__EMPTY_10 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "BEER/WINE";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_10;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_11;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}

if(a.__EMPTY_12 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.innerHTML =  "DELI/PREP";
    di.classList.add("inboxdiv");
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_12;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_13;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}

if(a.__EMPTY_14 > 0){
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "FLORAL";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_14;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_15;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}
if(a.__EMPTY_16 > 0){


    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "MEAT";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_16;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_17;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");

    di = document.createElement("div");
    di.innerHTML =" ";
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}

if(a.__EMPTY_18 > 0){  
    // create wrapper
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "PRODUCE";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_18;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_19;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id

        
    nn.setAttribute("id","nothing");    
}


if(a.__EMPTY_20 > 0){   
    di = document.createElement("div");
    di.setAttribute("id","inwrap");
    di.classList.add("inboxdiv");
    di.innerHTML =  "SEAFOOD";
    add.appendChild(di);
    var nn = document.getElementById("inwrap");
    // count
    di = document.createElement("div");
    di.innerHTML ="Count: " + a.__EMPTY_20;
    di.classList.add("inbox");
    nn.appendChild(di);
    
    // $
    di = document.createElement("div");
    di.innerHTML ="Value: $" + a.__EMPTY_21;
    di.classList.add("inbox");
    nn.appendChild(di);
        // reset id
    nn.setAttribute("id","nothing");
}   

    //create useful information

    var hh = document.createElement("h1");
    hh.classList.add("headerinfo");
    hh.textContent = "Useful Information"
    add.appendChild(hh);




    




if(a.__EMPTY == null){
    topTen.sort((a, b) => parseFloat(b.count) - parseFloat(a.count));
var kk = document.createElement("ol");
    kk.setAttribute("id", "oList");
    kk.classList.add("ol");
    add.appendChild(kk);
    var yy = document.getElementById("oList");


var oo = document.createElement("li");

    for(var j = 1; j <= 10; j++){
    oo = document.createElement("li");
    oo.innerHTML = topTen[j].name + " " + topTen[j].lname + "____Count: " + topTen[j].count + "___Value: $" + topTen[j].value;
    yy.appendChild(oo);
    }

}else {
var kk = document.createElement("ul");
    kk.setAttribute("id", "oList");
    kk.classList.add("ol");
    add.appendChild(kk);
    var yy = document.getElementById("oList");


var oo = document.createElement("li");
    oo.textContent = "Never void a product and key enter it into a department to change the price. Please call a supervisor.";
    yy.appendChild(oo);

    oo = document.createElement("li");
    oo.textContent = "Typically, when entering a CLU, you type the ten digits in the center of the label; if you get an error, try including the first digit on the tag (7-41735-01528)";
    yy.appendChild(oo);

    oo = document.createElement("li");
    oo.textContent = "When entering a label from the Meat, Seafood, Deli, or Food Service department, you must drop the last digit. (741735-204999) <-- Will give an error. The last digit '9' in this example is removed. (741735-20499) <-- Correct.";
    yy.appendChild(oo);

    oo = document.createElement("li");
    oo.textContent = "Meat, Seafood, Deli, and Food Service items over $100 will not print a barcode. If it is a Meat department product, it will have a 3-digit PLU at the end of the description. 'CAB roast (684)'. Enter in the PLU and then the price on the label. Please call a supervisor for help entering a Seafood, Deli, or Food Service product over $100.";
    yy.appendChild(oo);

    oo = document.createElement("li");
    oo.textContent = "If your item scans and a not on file error is displayed, press the Department key on the right, choose the department it belongs to, and enter the item's price.";
    yy.appendChild(oo);
}





    yy.setAttribute("id", "nothing");
    add.setAttribute("id","nothing");
   

	

}
        
    }



</script>
</head>

<body>
    <!--
<input type="file" id="fileUpload" />
<input type="button" id="upload" value="Upload" onclick="Upload()" />
<hr />
<div id="dvExcel"></div>
    -->
<input type="file" id="fileUpload1" />
<input type="button" id="upload1" value="Magic" onclick="Upload1()" />
<hr />
<div id="dvExcel1"></div>
<div id="test"></div>
</body>
<style>
    div#dvExcel1 {
	page-break-after: always;
	}	

    .border {
        width: 950px;
        height: 1200px;
        border: 2px solid black;
	    page-break-after: always;
	    
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-evenly;
        
        align-content: flex-start;
    }
   

    .inboxdiv {
        width: 150px;
        height: 100px;
        border: 1px solid black;
        text-align: center;
        font-size: 1.4em;
        box-shadow: black 5px 5px 5px;
        border-radius: 10%;
	margin: 15px;
    }

    .inboxhead {
        width: 100%;
        height: 100px;
        border: 1px solid black;
        font-size: 3.5em;
        text-align: center;
        font-weight: bold;
    }

    .inbox {
        text-align: left;
        padding-left: 4px;
    }

    li {
        font-size: 1.8em;
        padding: 10px 10px;
    }

    h1{
        font-size: 3.1em;
        width: 100%;
        text-align: center;
    }
    #text {
        background-color: gray;
    }
</style>
</html>

